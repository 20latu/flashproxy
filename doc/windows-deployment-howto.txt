This document describes the setup required to bundle
the client programs with a Python interpreter, for 
deployment on Windows machines without Python installed.

== Overview

The client programs are written in Python, an interpreted
language. The Python interpreter does not ship with Windows,
so in order for users to be able to download and  run the 
programs with no extra setup, it must be included in the 
distribution. This is currently done using PyInstaller.
PyInstaller collects the Python interpreter, any libraries
the Python script requires, and converts the script into
a standalone executable. 

The makefile has an "exe" target which automates the
budling process once all the required dependencies are 
installed. It should be run in Cygwin.

== Dependencies

The client programs use a few libraries, which must
be present on the system in order for PyInstaller to
bundle them. Bundling also requires a Windows Python
installation and PyInstaller.

1. Python  http://python.org/download/

Get the latest 32-bit installer in the 2.x series.
http://python.org/ftp/python/2.7.3/python-2.7.3.msi
http://python.org/ftp/python/2.7.3/python-2.7.3.msi.asc
There are instructions for verifying the signature on the download page.
$ gpg --verify python-2.7.3.msi.asc

Run the installer. "Install for all users". You can disable "Tcl/Tk",
"Documentation", "Utility Scripts", and "Test suite".

Set the PATH environment variable as described at
http://docs.python.org/2/using/windows.html#configuring-python
PATH=...;C:\Python27
You will have to restart your shells to pick up the new PATH.

1.5 pywin32  http://sourceforge.net/projects/pywin32/files/pywin32/

This is a prerequisite for PyInstaller. Enter the directory containing
the latest build number, then download the "win32-py2.7" package.

The installers don't seem to have signatures. The sha256sum of the
package I downloaded was

dd665cca88cb059fec960516ed5f29474b33fce50fcb2633d397d4a3aa705c16 *pywin32-218.win32-py2.7.exe

2. PyInstaller

The 2.0 release can be found at http://www.pyinstaller.org.
The program is a Python script, there is no installation
required, just extract the archive somehwere.

3. OpenSSL

There are no official binary distributions of OpenSSL.
The source is available at http://www.openssl.org/source/.
This page provides links to unofficial binary distributions,
http://www.openssl.org/related/binaries.html.

4. M2Crypto

There are no official binary distributions of M2Crypto.
The official source along, with several unofficial
binaries, is available at http://chandlerproject.org/Projects/MeTooCrypto.

== Bundling

Once the dependencies are installed, you should be able
to bundle the programs, using the "exe" make target.
Do not install Cygwin Python, make sure you are using the
native Windows version. Add Python and PyInstaller to your 
path, then in a Cygwin terminal run:

$ make exe

This will create a dist/flashproxy-client-<version> directory
containing the required binaries. If you encounter any
problems, please report them using https://trac.torproject.org/projects/tor.
